<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sessions 3 lab exercise: Regression analysis of contraceptive use data • session3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sessions 3 lab exercise: Regression analysis of contraceptive use data">
<meta property="og:description" content="session3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-176789980-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176789980-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">session3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lecture and Lab
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/session_lecture.html">Lecture notes</a>
    </li>
    <li>
      <a href="../articles/session_lecture.pdf">Lecture notes PDF</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/session_lab.html">Lab materials</a>
    </li>
  </ul>
</li>
<li class="dropdown-header">
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronbios2/session3/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/leviwaldron1">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="session_lab_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sessions 3 lab exercise: Regression analysis of contraceptive use data</h1>
                        <h4 class="author">Levi Waldron</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronbios2/session3/blob/master/vignettes/session_lab.Rmd"><code>vignettes/session_lab.Rmd</code></a></small>
      <div class="hidden name"><code>session_lab.Rmd</code></div>

    </div>

    
    
<p><strong>Learning objectives</strong></p>
<ol style="list-style-type: decimal">
<li>perform and interpret logistic regression
<ul>
<li>interpret logistic regression coefficients</li>
<li>make predictions based on a logistic regression model</li>
</ul>
</li>
<li>perform and interpret likelihood ratio test</li>
</ol>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>What is the mean fraction of women using birth control for each age group? Each education level? For women who do or don’t want more children?
<ul>
<li>Hint: look at the “data wrangling” cheat sheet functions <code>mutate</code>, <code>group_by</code>, and <code>summarize</code>
</li>
</ul>
</li>
<li>Based on <code>fit1</code>, write on paper the model for expected probability of using birth control. Don’t forget the logit function.</li>
<li>Based on <code>fit1</code>, what is the expected probability of an individual 25-29 years old, with high education, who wants more children, using birth control? Calculate it manually, and using <code><a href="https://rdrr.io/r/stats/predict.html">predict(fit1)</a></code>
</li>
<li>Based on <code>fit1</code>: Relative to women under 25 who want to have children, what is the predicted increase in odds that a woman 40-49 years old who does <em>not</em> want to have children will be taking birth control?</li>
<li>Using a likelihood ratio test, is there evidence that a model with interactions improves on <code>fit1</code> (no interactions)?</li>
<li>Which, if any, variables have the strongest interactions?</li>
<li>Looking at the effect of age only, consider contrasts between <em>every pair</em> of age groups. Between which age groups is the contrast significant?</li>
</ol>
<div id="load-and-explore-the-contraceptive-use-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-and-explore-the-contraceptive-use-data" class="anchor"></a>Load and explore the contraceptive use data</h1>
<p>Load the data from <a href="http://data.princeton.edu/wws509/datasets/#cuse" class="uri">http://data.princeton.edu/wws509/datasets/#cuse</a>. From this page: &gt; These data show the distribution of 1607 currently married and fecund women interviewed in the Fiji Fertility Survey, according to age, education, desire for more children and current use of contraception.</p>
<p>See Session 2 for some discussion about reading this file. Here we just do it.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">readr</span>)
<span class="no">cuse</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table2</a></span>(<span class="st">"cuse.dat"</span>,
    <span class="kw">col_types</span> <span class="kw">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span>(
      <span class="kw">age</span> <span class="kw">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span>(<span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"&lt;25"</span>, <span class="st">"25-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>)),
      <span class="kw">education</span> <span class="kw">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span>(<span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"high"</span>)),
      <span class="kw">wantsMore</span> <span class="kw">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span>(<span class="kw">levels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>)),
      <span class="kw">X6</span> <span class="kw">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/col_skip.html">col_skip</a></span>()
    )
  )</pre></body></html></div>
<pre><code>## Warning: Missing column names filled in: 'X6' [6]</code></pre>
<pre><code>## Warning: 16 parsing failures.
## row col  expected    actual       file
##   1  -- 6 columns 5 columns 'cuse.dat'
##   2  -- 6 columns 5 columns 'cuse.dat'
##   3  -- 6 columns 5 columns 'cuse.dat'
##   4  -- 6 columns 5 columns 'cuse.dat'
##   5  -- 6 columns 5 columns 'cuse.dat'
## ... ... ......... ......... ..........
## See problems(...) for more details.</code></pre>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">cuse</span>)</pre></body></html></div>
<pre><code>##     age    education wantsMore    notUsing          using      
##  &lt;25  :4   low :8    no :8     Min.   :  8.00   Min.   : 4.00  
##  25-29:4   high:8    yes:8     1st Qu.: 31.00   1st Qu.: 9.50  
##  30-39:4                       Median : 56.50   Median :29.00  
##  40-49:4                       Mean   : 68.75   Mean   :31.69  
##                                3rd Qu.: 85.75   3rd Qu.:49.00  
##                                Max.   :212.00   Max.   :80.00</code></pre>
</div>
<div id="what-is-the-mean-fraction-of-women-using-birth-control-for" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-the-mean-fraction-of-women-using-birth-control-for" class="anchor"></a>What is the mean fraction of women using birth control for…</h1>
<p>What is the mean fraction of women using birth control for each age group? Each education level? For women who do or don’t want more children? - Hint: look at the <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">“Data Transformation Cheatsheet”</a> functions <code>mutate</code>, <code>group_by</code>, and <code>summarize</code>. This is one of several very handy cheatsheets produced by RStudio, see <a href="https://rstudio.com/resources/cheatsheets/" class="uri">https://rstudio.com/resources/cheatsheets/</a> for a list.</p>
<p><strong>Solution</strong></p>
<p>First create a new column containing the fraction using contraception:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">cuse2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="no">cuse</span>, <span class="kw">fracusing</span> <span class="kw">=</span> <span class="no">using</span> / (<span class="no">using</span> + <span class="no">notUsing</span>))
<span class="no">cuse2</span></pre></body></html></div>
<pre><code>## # A tibble: 16 x 6
##    age   education wantsMore notUsing using fracusing
##    &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 &lt;25   low       yes             53     6     0.102
##  2 &lt;25   low       no              10     4     0.286
##  3 &lt;25   high      yes            212    52     0.197
##  4 &lt;25   high      no              50    10     0.167
##  5 25-29 low       yes             60    14     0.189
##  6 25-29 low       no              19    10     0.345
##  7 25-29 high      yes            155    54     0.258
##  8 25-29 high      no              65    27     0.293
##  9 30-39 low       yes            112    33     0.228
## 10 30-39 low       no              77    80     0.510
## 11 30-39 high      yes            118    46     0.280
## 12 30-39 high      no              68    78     0.534
## 13 40-49 low       yes             35     6     0.146
## 14 40-49 low       no              46    48     0.511
## 15 40-49 high      yes              8     8     0.5  
## 16 40-49 high      no              12    31     0.721</code></pre>
<p>Now, group and summarize by age:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">cuse2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">age</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">fracusing</span>))</pre></body></html></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 4 x 2
##   age   `mean(fracusing)`
##   &lt;fct&gt;             &lt;dbl&gt;
## 1 &lt;25               0.188
## 2 25-29             0.271
## 3 30-39             0.388
## 4 40-49             0.469</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">cuse2</span></pre></body></html></div>
<pre><code>## # A tibble: 16 x 6
##    age   education wantsMore notUsing using fracusing
##    &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 &lt;25   low       yes             53     6     0.102
##  2 &lt;25   low       no              10     4     0.286
##  3 &lt;25   high      yes            212    52     0.197
##  4 &lt;25   high      no              50    10     0.167
##  5 25-29 low       yes             60    14     0.189
##  6 25-29 low       no              19    10     0.345
##  7 25-29 high      yes            155    54     0.258
##  8 25-29 high      no              65    27     0.293
##  9 30-39 low       yes            112    33     0.228
## 10 30-39 low       no              77    80     0.510
## 11 30-39 high      yes            118    46     0.280
## 12 30-39 high      no              68    78     0.534
## 13 40-49 low       yes             35     6     0.146
## 14 40-49 low       no              46    48     0.511
## 15 40-49 high      yes              8     8     0.5  
## 16 40-49 high      no              12    31     0.721</code></pre>
<p>Here the <code><a href="https://dplyr.tidyverse.org/reference/reexports.html">%&gt;%</a></code> is called a “pipe”, and it sends the output of the previous function to the input of the next function. This could also have been done in one step:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="no">cuse</span>, <span class="kw">fracusing</span> <span class="kw">=</span> <span class="no">using</span> / (<span class="no">using</span> + <span class="no">notUsing</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">age</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">fracusing</span>))</pre></body></html></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 4 x 2
##   age   `mean(fracusing)`
##   &lt;fct&gt;             &lt;dbl&gt;
## 1 &lt;25               0.188
## 2 25-29             0.271
## 3 30-39             0.388
## 4 40-49             0.469</code></pre>
<p>Here the result is not stored anywhere; if you wanted to store it in a variable called <code>myanswer</code>, you could have started the above command with <code>myanswer &lt;-</code> or <code>myanswer =</code>.</p>
<p>Also note that the line breaks are optional: you could put this all on one line, but breaking it up makes it more readable.</p>
</div>
<div id="write-on-paper-the-model-for-expected-probability-of-using-birth-control" class="section level1">
<h1 class="hasAnchor">
<a href="#write-on-paper-the-model-for-expected-probability-of-using-birth-control" class="anchor"></a>Write on paper the model for expected probability of using birth control</h1>
<p>Based on <code>fit1</code>, write on paper the model for expected probability of using birth control? Don’t forget the (inverse) logit function.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">fit1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">using</span>, <span class="no">notUsing</span>) ~ <span class="no">age</span> + <span class="no">education</span> + <span class="no">wantsMore</span>,
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">cuse</span>,
  <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="st">"logit"</span>)
)</pre></body></html></div>
<p>I’m going to store the coefficients of <code>fit1</code> in a new variable <code>b</code> just to save typing when writing out the formula, and round to two decimal places:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">bcoef</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">fit1</span>), <span class="fl">2</span>)</pre></body></html></div>
<p>Here I’m going to take advantage of R Markdown’s support for LaTeX formulae to write out the fitted regression model. I also use the ` r 2+2 ` syntax (the result is 4) for putting results of R code inline, instead of writing out numbers of the coefficients. I never wrote the number “four”, but you’ll have to look at the .Rmd to see how I did that! Doing this in reports allows you to update them as input data changes, without having to manually re-enter or copy numbers.</p>
<p><span class="math inline">\(P = \textit{logit}^{-1} \left(  -1.13 + 0.39 \times \textit{age25-29} +  0.91 \times \textit{age30-39} +  1.19 \times \textit{age40-49} +  NA \times \textit{educationlow} +  -0.83 \times \textit{wantsMoreyes}  \right)\)</span></p>
<p><span class="math inline">\(\textit{logit}^{-1}(x) = \frac{1}{1+e^{-x}}\)</span></p>
</div>
<div id="what-is-the-expected-probability" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-the-expected-probability" class="anchor"></a>What is the expected probability…</h1>
<p>Based on <code>fit1</code>, what is the expected probability of an individual 25-29 years old, with high education, who wants more children, using birth control? Calculate it manually, and using <code><a href="https://rdrr.io/r/stats/predict.html">predict(fit1)</a></code></p>
<p><strong>Solution</strong></p>
<p>This can be done using the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function, using a new <code>data.frame</code> giving the values that you want to predict for:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">invLogit</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fl">1</span>/(<span class="fl">1</span>+<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(-<span class="no">x</span>))
<span class="no">newdata</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">age</span><span class="kw">=</span><span class="st">"25-29"</span>, <span class="kw">education</span><span class="kw">=</span><span class="st">"high"</span>, <span class="kw">wantsMore</span><span class="kw">=</span><span class="st">"yes"</span>)
<span class="fu">invLogit</span>( <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit1</span>, <span class="kw">newdata</span><span class="kw">=</span><span class="no">newdata</span>) )</pre></body></html></div>
<pre><code>##         1 
## 0.2223899</code></pre>
<p>By default, <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> predicts on the original data, and taking a look, I noticed that the 7th value is the one we want to predict on:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu">invLogit</span>( <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit1</span>)[<span class="fl">7</span>] )</pre></body></html></div>
<pre><code>##         7 
## 0.2223899</code></pre>
<p>If we were really doing this manually, on paper, we would just calculate the linear predictor, then use the inverse logit function. Note that education=“high” is the reference group, so we don’t use it here:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu">invLogit</span>( <span class="no">bcoef</span>[<span class="st">"(Intercept)"</span>] + <span class="no">bcoef</span>[<span class="st">"age25-29"</span>] + <span class="no">bcoef</span>[<span class="st">"wantsMoreyes"</span>] )</pre></body></html></div>
<pre><code>## (Intercept) 
##   0.1722164</code></pre>
<p>I don’t <em>really</em> care, but if the remnant “(Intercept)” name there were annoying me, I would assign this to a variable then get rid of that name:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu">invLogit</span>( <span class="no">bcoef</span>[<span class="st">"(Intercept)"</span>] + <span class="no">bcoef</span>[<span class="st">"age25-29"</span>] + <span class="no">bcoef</span>[<span class="st">"wantsMoreyes"</span>] )
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">res</span>) <span class="kw">&lt;-</span> <span class="kw">NULL</span>
<span class="no">res</span></pre></body></html></div>
<pre><code>## [1] 0.1722164</code></pre>
</div>
<div id="predicted-odds-ratio" class="section level1">
<h1 class="hasAnchor">
<a href="#predicted-odds-ratio" class="anchor"></a>Predicted odds ratio</h1>
<p>Based on <code>fit1</code>: Relative to women under 25 who want to have children, what is the predicted odds ratio for a woman 40-49 years old who does <em>not</em> want to have children will be taking birth control?</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>( <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">fit1</span>)[<span class="st">"age40-49"</span>] - <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">fit1</span>)[<span class="st">"wantsMoreyes"</span>])</pre></body></html></div>
<pre><code>## age40-49 
##  7.55488</code></pre>
</div>
<div id="likelihood-ratio-test" class="section level1">
<h1 class="hasAnchor">
<a href="#likelihood-ratio-test" class="anchor"></a>Likelihood Ratio Test</h1>
<p>Using a likelihood ratio test, is there evidence that a model with interactions improves on <code>fit1</code> (no interactions)?</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">fit1.int</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">using</span>, <span class="no">notUsing</span>) ~ <span class="no">age</span> * <span class="no">education</span> * <span class="no">wantsMore</span>,
           <span class="kw">data</span><span class="kw">=</span><span class="no">cuse</span>, <span class="kw">family</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="st">"logit"</span>))
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(<span class="no">fit1</span>, <span class="no">fit1.int</span>, <span class="kw">test</span><span class="kw">=</span><span class="st">"LRT"</span>)</pre></body></html></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: cbind(using, notUsing) ~ age + education + wantsMore
## Model 2: cbind(using, notUsing) ~ age * education * wantsMore
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1        10     29.917                          
## 2         0      0.000 10   29.917 0.0008838 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="a-model-with-interactions" class="section level1">
<h1 class="hasAnchor">
<a href="#a-model-with-interactions" class="anchor"></a>A model with interactions</h1>
<p>Which, if any, variables have the strongest interactions? I use the “stargazer” package here which is extremely flexible for showing regression results from all kinds of models, capable of comparing multiple models or multiple dependent variables in the same table, and providing formatting customized to numerous journal styles.</p>
<p><strong>Solution</strong></p>
<p>We see here that the strongest interaction coeffient is for <code>age30-39:wantsMoreyes</code>. It is statistically significant and negative (0). It appears that being 30-39 years old and wanting more children has a multiplicative effect against using birth control, moreso than expected based on the age or wanting more children alone.</p>
<p>The <em>stargazer</em> package is a good way to create nicely-formatted tables of regression results.</p>
<table class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Outcome: Using Birth Control
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
No Interaction
</td>
<td>
With Interactions
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29
</td>
<td>
0.39<sup>**</sup> (0.04, 0.73)
</td>
<td>
0.27 (-1.12, 1.66)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39
</td>
<td>
0.91<sup>***</sup> (0.59, 1.23)
</td>
<td>
0.95 (-0.25, 2.16)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49
</td>
<td>
1.19<sup>***</sup> (0.77, 1.61)
</td>
<td>
0.96 (-0.27, 2.19)
</td>
</tr>
<tr>
<td style="text-align:left">
educationhigh
</td>
<td>
0.32<sup>***</sup> (0.08, 0.57)
</td>
<td>
-0.69 (-2.04, 0.65)
</td>
</tr>
<tr>
<td style="text-align:left">
wantsMoreyes
</td>
<td>
-0.83<sup>***</sup> (-1.06, -0.60)
</td>
<td>
-1.26<sup>*</sup> (-2.70, 0.17)
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29:educationhigh
</td>
<td>
</td>
<td>
0.46 (-1.15, 2.07)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39:educationhigh
</td>
<td>
</td>
<td>
0.79 (-0.63, 2.21)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49:educationhigh
</td>
<td>
</td>
<td>
1.60<sup>**</sup> (0.05, 3.15)
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29:wantsMoreyes
</td>
<td>
</td>
<td>
0.45 (-1.28, 2.18)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39:wantsMoreyes
</td>
<td>
</td>
<td>
0.002 (-1.52, 1.52)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49:wantsMoreyes
</td>
<td>
</td>
<td>
-0.54 (-2.27, 1.18)
</td>
</tr>
<tr>
<td style="text-align:left">
educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
1.47<sup>*</sup> (-0.15, 3.08)
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29:educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
-0.83 (-2.79, 1.13)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39:educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
-1.29 (-3.04, 0.47)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49:educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
-0.61 (-2.83, 1.61)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-1.13<sup>***</sup> (-1.50, -0.77)
</td>
<td>
-0.92 (-2.08, 0.24)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
16
</td>
<td>
16
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-50.71
</td>
<td>
-35.75
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
113.43
</td>
<td>
103.51
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05; <sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="contrasts-between-every-pair-of-age-groups" class="section level1">
<h1 class="hasAnchor">
<a href="#contrasts-between-every-pair-of-age-groups" class="anchor"></a>Contrasts between every pair of age groups</h1>
<p>Create a model matrix for a fit on age only, with contrasts between <em>every pair</em> of age groups. Between which age groups is the contrast significant?</p>
<p><strong>Solution</strong></p>
<div id="semi-manually" class="section level2">
<h2 class="hasAnchor">
<a href="#semi-manually" class="anchor"></a>semi-manually</h2>
<p>First, I’ll do it manually, using the <code>multcomp</code> package and following an example from <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html">?glht</a></code>. I’m not going to bother anymore creating pretty tables with <code>stargazer</code> though…</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="no">fit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">using</span>, <span class="no">notUsing</span>) ~ <span class="no">age</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">cuse</span>, <span class="kw">family</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span>(<span class="st">"logit"</span>))
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(<span class="no">fit</span>)</pre></body></html></div>
<pre><code>## (Intercept)    age25-29    age30-39    age40-49 
##  -1.5071591   0.4606758   1.0482932   1.4246380</code></pre>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">K</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="st">"25-29 - &lt;25"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>),
           <span class="st">"30-39 - &lt;25"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>),
           <span class="st">"40-49 - &lt;25"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
           <span class="st">"30-39 - 25-29"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, -<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>),
           <span class="st">"40-49 - 25-29"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, -<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>),
           <span class="st">"40-49 - 30-39"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, -<span class="fl">1</span>, <span class="fl">1</span>))
<span class="no">K</span></pre></body></html></div>
<pre><code>##               [,1] [,2] [,3] [,4]
## 25-29 - &lt;25     -1    1    0    0
## 30-39 - &lt;25     -1    0    1    0
## 40-49 - &lt;25     -1    0    0    1
## 30-39 - 25-29    0   -1    1    0
## 40-49 - 25-29    0   -1    0    1
## 40-49 - 30-39    0    0   -1    1</code></pre>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">fit.all.cont</span> <span class="kw">=</span> <span class="kw pkg">multcomp</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span>(<span class="no">fit</span>, <span class="kw">linfct</span><span class="kw">=</span><span class="no">K</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">fit.all.cont</span>)</pre></body></html></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: glm(formula = cbind(using, notUsing) ~ age, family = binomial("logit"), 
##     data = cuse)
## 
## Linear Hypotheses:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## 25-29 - &lt;25 == 0     1.9678     0.2841   6.926   &lt;0.001 ***
## 30-39 - &lt;25 == 0     2.5555     0.2734   9.347   &lt;0.001 ***
## 40-49 - &lt;25 == 0     2.9318     0.2975   9.854   &lt;0.001 ***
## 30-39 - 25-29 == 0   0.5876     0.1406   4.181   &lt;0.001 ***
## 40-49 - 25-29 == 0   0.9640     0.1831   5.265   &lt;0.001 ***
## 40-49 - 30-39 == 0   0.3763     0.1660   2.268   0.0984 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
<div id="using-tukey-contrasts" class="section level2">
<h2 class="hasAnchor">
<a href="#using-tukey-contrasts" class="anchor"></a>Using Tukey contrasts</h2>
<p>There is an easier way if you realize that these are the “Tukey” contrasts and use the <code>contrMat</code> function from the <code>multcomp</code> package:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">K2</span> <span class="kw">=</span> <span class="kw pkg">multcomp</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html">contrMat</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">"Tukey"</span>)
<span class="no">K2</span></pre></body></html></div>
<pre><code>## 
##   Multiple Comparisons of Means: Tukey Contrasts
## 
##        1  2  3 4
## 2 - 1 -1  1  0 0
## 3 - 1 -1  0  1 0
## 4 - 1 -1  0  0 1
## 3 - 2  0 -1  1 0
## 4 - 2  0 -1  0 1
## 4 - 3  0  0 -1 1</code></pre>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">fit.all.cont2</span> <span class="kw">=</span> <span class="kw pkg">multcomp</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span>(<span class="no">fit</span>, <span class="kw">linfct</span><span class="kw">=</span><span class="no">K2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">fit.all.cont2</span>)</pre></body></html></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: glm(formula = cbind(using, notUsing) ~ age, family = binomial("logit"), 
##     data = cuse)
## 
## Linear Hypotheses:
##            Estimate Std. Error z value Pr(&gt;|z|)    
## 2 - 1 == 0   1.9678     0.2841   6.926   &lt;0.001 ***
## 3 - 1 == 0   2.5555     0.2734   9.347   &lt;0.001 ***
## 4 - 1 == 0   2.9318     0.2975   9.854   &lt;0.001 ***
## 3 - 2 == 0   0.5876     0.1406   4.181   &lt;0.001 ***
## 4 - 2 == 0   0.9640     0.1831   5.265   &lt;0.001 ***
## 4 - 3 == 0   0.3763     0.1660   2.268   0.0981 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>We didn’t get the same informative coefficient names this time, but we could have just by renaming the rows in <code>K2</code>, for example:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">K2</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">K</span>)
<span class="no">K2</span></pre></body></html></div>
<pre><code>## 
##   Multiple Comparisons of Means: Tukey Contrasts
## 
##                1  2  3 4
## 25-29 - &lt;25   -1  1  0 0
## 30-39 - &lt;25   -1  0  1 0
## 40-49 - &lt;25   -1  0  0 1
## 30-39 - 25-29  0 -1  1 0
## 40-49 - 25-29  0 -1  0 1
## 40-49 - 30-39  0  0 -1 1</code></pre>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>( <span class="kw pkg">multcomp</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span>(<span class="no">fit</span>, <span class="kw">linfct</span><span class="kw">=</span><span class="no">K2</span>) )</pre></body></html></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: glm(formula = cbind(using, notUsing) ~ age, family = binomial("logit"), 
##     data = cuse)
## 
## Linear Hypotheses:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## 25-29 - &lt;25 == 0     1.9678     0.2841   6.926   &lt;0.001 ***
## 30-39 - &lt;25 == 0     2.5555     0.2734   9.347   &lt;0.001 ***
## 40-49 - &lt;25 == 0     2.9318     0.2975   9.854   &lt;0.001 ***
## 30-39 - 25-29 == 0   0.5876     0.1406   4.181   &lt;0.001 ***
## 40-49 - 25-29 == 0   0.9640     0.1831   5.265   &lt;0.001 ***
## 40-49 - 30-39 == 0   0.3763     0.1660   2.268    0.098 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
<div id="other-contrast-schemes" class="section level2">
<h2 class="hasAnchor">
<a href="#other-contrast-schemes" class="anchor"></a>Other contrast schemes</h2>
<p>There are plenty of canned contrast schemes provided by <code><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html">multcomp::contrMat</a></code>. Note use of the <code><a href="https://rdrr.io/r/utils/example.html">example()</a></code> function to run all examples from the <code>contrmat()</code> function. This is a great example of how there are <strong>many</strong> ways to analyze one particular experimental design, but that you need to know design matrices to utilize many of them.</p>
<p>In these examples, the first line <code>n &lt;- c(10,20,30,40)</code> just signifies four levels, <code>n = 1:4</code> would do exactly the same thing.</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">multcomp</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span>(<span class="st">"contrMat"</span>)</pre></body></html></div>
<pre><code>## 
## cntrMt&gt;  n &lt;- c(10,20,30,40)
## 
## cntrMt&gt;  names(n) &lt;- paste("group", 1:4, sep="")
## 
## cntrMt&gt;  contrMat(n) # Dunnett is default
## 
##   Multiple Comparisons of Means: Dunnett Contrasts
## 
##                 group1 group2 group3 group4
## group2 - group1     -1      1      0      0
## group3 - group1     -1      0      1      0
## group4 - group1     -1      0      0      1
## 
## cntrMt&gt;  contrMat(n, base = 2)   # use second level as baseline
## 
##   Multiple Comparisons of Means: Dunnett Contrasts
## 
##                 group1 group2 group3 group4
## group1 - group2      1     -1      0      0
## group3 - group2      0     -1      1      0
## group4 - group2      0     -1      0      1
## 
## cntrMt&gt;  contrMat(n, type = "Tukey")
## 
##   Multiple Comparisons of Means: Tukey Contrasts
## 
##                 group1 group2 group3 group4
## group2 - group1     -1      1      0      0
## group3 - group1     -1      0      1      0
## group4 - group1     -1      0      0      1
## group3 - group2      0     -1      1      0
## group4 - group2      0     -1      0      1
## group4 - group3      0      0     -1      1
## 
## cntrMt&gt;  contrMat(n, type = "Sequen")
## 
##   Multiple Comparisons of Means: Sequen Contrasts
## 
##                 group1 group2 group3 group4
## group2 - group1     -1      1      0      0
## group3 - group2      0     -1      1      0
## group4 - group3      0      0     -1      1
## 
## cntrMt&gt;  contrMat(n, type = "AVE")
## 
##   Multiple Comparisons of Means: AVE Contrasts
## 
##      group1  group2  group3  group4
## C 1  1.0000 -0.2222 -0.3333 -0.4444
## C 2 -0.1250  1.0000 -0.3750 -0.5000
## C 3 -0.1429 -0.2857  1.0000 -0.5714
## C 4 -0.1667 -0.3333 -0.5000  1.0000
## 
## cntrMt&gt;  contrMat(n, type = "Changepoint")
## 
##   Multiple Comparisons of Means: Changepoint Contrasts
## 
##      group1  group2  group3 group4
## C 1 -1.0000  0.2222  0.3333 0.4444
## C 2 -0.3333 -0.6667  0.4286 0.5714
## C 3 -0.1667 -0.3333 -0.5000 1.0000
## 
## cntrMt&gt;  contrMat(n, type = "Williams")
## 
##   Multiple Comparisons of Means: Williams Contrasts
## 
##     group1 group2 group3 group4
## C 1     -1 0.0000 0.0000 1.0000
## C 2     -1 0.0000 0.4286 0.5714
## C 3     -1 0.2222 0.3333 0.4444
## 
## cntrMt&gt;  contrMat(n, type = "Marcus")
## 
##   Multiple Comparisons of Means: Marcus Contrasts
## 
##      group1  group2  group3 group4
## C 1 -1.0000  0.2222  0.3333 0.4444
## C 2 -1.0000  0.0000  0.4286 0.5714
## C 3 -0.3333 -0.6667  0.4286 0.5714
## C 4 -1.0000  0.0000  0.0000 1.0000
## C 5 -0.3333 -0.6667  0.0000 1.0000
## C 6 -0.1667 -0.3333 -0.5000 1.0000
## 
## cntrMt&gt;  contrMat(n, type = "McDermott")
## 
##   Multiple Comparisons of Means: McDermott Contrasts
## 
##      group1  group2 group3 group4
## C 1 -1.0000  1.0000    0.0      0
## C 2 -0.3333 -0.6667    1.0      0
## C 3 -0.1667 -0.3333   -0.5      1
## 
## cntrMt&gt;  ### Umbrella-protected Williams contrasts, i.e. a sequence of 
## cntrMt&gt;  ### Williams-type contrasts with groups of higher order 
## cntrMt&gt;  ### stepwise omitted
## cntrMt&gt;  contrMat(n, type = "UmbrellaWilliams")
## 
##   Multiple Comparisons of Means: UmbrellaWilliams Contrasts
## 
##     group1 group2 group3 group4
## C 1     -1 0.0000 0.0000 1.0000
## C 2     -1 0.0000 0.4286 0.5714
## C 3     -1 0.2222 0.3333 0.4444
## C 4     -1 0.0000 1.0000 0.0000
## C 5     -1 0.4000 0.6000 0.0000
## C 6     -1 1.0000 0.0000 0.0000
## 
## cntrMt&gt;  ### comparison of each group with grand mean of all groups
## cntrMt&gt;  contrMat(n, type = "GrandMean")
## 
##   Multiple Comparisons of Means: GrandMean Contrasts
## 
##        group1 group2 group3 group4
## group1    0.9   -0.2   -0.3   -0.4
## group2   -0.1    0.8   -0.3   -0.4
## group3   -0.1   -0.2    0.7   -0.4
## group4   -0.1   -0.2   -0.3    0.6</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://waldronlab.io">Levi Waldron</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
