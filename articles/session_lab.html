<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sessions 3 lab exercise: Regression analysis of contraceptive use data • session3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sessions 3 lab exercise: Regression analysis of contraceptive use data">
<meta property="og:description" content="session3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-176789980-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176789980-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">session3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lecture and Lab
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/session_lecture.html">Lecture notes</a>
    </li>
    <li>
      <a href="../articles/session_lecture.pdf">Lecture notes PDF</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/session_lab.html">Lab materials</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronbios2/session3/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/leviwaldron1" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sessions 3 lab exercise: Regression analysis of
contraceptive use data</h1>
                        <h4 data-toc-skip class="author">Levi
Waldron</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronbios2/session3/blob/HEAD/vignettes/session_lab.Rmd" class="external-link"><code>vignettes/session_lab.Rmd</code></a></small>
      <div class="hidden name"><code>session_lab.Rmd</code></div>

    </div>

    
    
<p><strong>Learning objectives</strong></p>
<ol style="list-style-type: decimal">
<li>perform and interpret logistic regression
<ul>
<li>interpret logistic regression coefficients</li>
<li>make predictions based on a logistic regression model</li>
</ul>
</li>
<li>perform and interpret likelihood ratio test</li>
</ol>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>What is the mean fraction of women using birth control for each age
group? Each education level? For women who do or don’t want more
children?
<ul>
<li>Hint: look at the “data wrangling” cheat sheet functions
<code>mutate</code>, <code>group_by</code>, and
<code>summarize</code>
</li>
</ul>
</li>
<li>Based on <code>fit1</code>, write on paper the model for expected
probability of using birth control. Don’t forget the logit
function.</li>
<li>Based on <code>fit1</code>, what is the expected probability of an
individual 25-29 years old, with high education, who wants more
children, using birth control? Calculate it manually, and using
<code>predict(fit1)</code>
</li>
<li>Based on <code>fit1</code>: Relative to women under 25 who want to
have children, what is the predicted increase in odds that a woman 40-49
years old who does <em>not</em> want to have children will be taking
birth control?</li>
<li>Using a likelihood ratio test, is there evidence that a model with
interactions improves on <code>fit1</code> (no interactions)?</li>
<li>Which, if any, variables have the strongest interactions?</li>
<li>Looking at the effect of age only, consider contrasts between
<em>every pair</em> of age groups. Between which age groups is the
contrast significant?</li>
</ol>
<div class="section level2">
<h2 id="load-and-explore-the-contraceptive-use-data">Load and explore the contraceptive use data<a class="anchor" aria-label="anchor" href="#load-and-explore-the-contraceptive-use-data"></a>
</h2>
<p>Load the data from <a href="http://data.princeton.edu/wws509/datasets/#cuse" class="external-link uri">http://data.princeton.edu/wws509/datasets/#cuse</a>. From
this page: &gt; These data show the distribution of 1607 currently
married and fecund women interviewed in the Fiji Fertility Survey,
according to age, education, desire for more children and current use of
contraception.</p>
<p>See Session 2 for some discussion about reading this file. Here we
just do it.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="va">cuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table2.html" class="external-link">read_table2</a></span><span class="op">(</span><span class="st">"cuse.dat"</span>,</span>
<span>    col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span></span>
<span>      age <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html" class="external-link">col_factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&lt;25"</span>, <span class="st">"25-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      education <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html" class="external-link">col_factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      wantsMore <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html" class="external-link">col_factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      X6 <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/col_skip.html" class="external-link">col_skip</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `read_table2()` was deprecated in readr 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `read_table()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: Missing column names filled in: 'X6' [6]</span></span></code></pre>
<pre><code><span><span class="co">## Warning: 16 parsing failures.</span></span>
<span><span class="co">## row col  expected    actual       file</span></span>
<span><span class="co">##   1  -- 6 columns 5 columns 'cuse.dat'</span></span>
<span><span class="co">##   2  -- 6 columns 5 columns 'cuse.dat'</span></span>
<span><span class="co">##   3  -- 6 columns 5 columns 'cuse.dat'</span></span>
<span><span class="co">##   4  -- 6 columns 5 columns 'cuse.dat'</span></span>
<span><span class="co">##   5  -- 6 columns 5 columns 'cuse.dat'</span></span>
<span><span class="co">## ... ... ......... ......... ..........</span></span>
<span><span class="co">## See problems(...) for more details.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cuse</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     age    education wantsMore    notUsing          using      </span></span>
<span><span class="co">##  &lt;25  :4   low :8    no :8     Min.   :  8.00   Min.   : 4.00  </span></span>
<span><span class="co">##  25-29:4   high:8    yes:8     1st Qu.: 31.00   1st Qu.: 9.50  </span></span>
<span><span class="co">##  30-39:4                       Median : 56.50   Median :29.00  </span></span>
<span><span class="co">##  40-49:4                       Mean   : 68.75   Mean   :31.69  </span></span>
<span><span class="co">##                                3rd Qu.: 85.75   3rd Qu.:49.00  </span></span>
<span><span class="co">##                                Max.   :212.00   Max.   :80.00</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="what-is-the-mean-fraction-of-women-using-birth-control-for">What is the mean fraction of women using birth control for…<a class="anchor" aria-label="anchor" href="#what-is-the-mean-fraction-of-women-using-birth-control-for"></a>
</h2>
<p>What is the mean fraction of women using birth control for each age
group? Each education level? For women who do or don’t want more
children? - Hint: look at the <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf" class="external-link">“Data
Transformation Cheatsheet”</a> functions <code>mutate</code>,
<code>group_by</code>, and <code>summarize</code>. This is one of
several very handy cheatsheets produced by RStudio, see <a href="https://rstudio.com/resources/cheatsheets/" class="external-link uri">https://rstudio.com/resources/cheatsheets/</a> for a
list.</p>
<p><strong>Solution</strong></p>
<p>First create a new column containing the fraction using
contraception:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">cuse2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">cuse</span>, fracusing <span class="op">=</span> <span class="va">using</span> <span class="op">/</span> <span class="op">(</span><span class="va">using</span> <span class="op">+</span> <span class="va">notUsing</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cuse2</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 16 × 6</span></span></span>
<span><span class="co">##    age   education wantsMore notUsing using fracusing</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> &lt;25   low       yes             53     6     0.102</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> &lt;25   low       no              10     4     0.286</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> &lt;25   high      yes            212    52     0.197</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> &lt;25   high      no              50    10     0.167</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 25-29 low       yes             60    14     0.189</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 25-29 low       no              19    10     0.345</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 25-29 high      yes            155    54     0.258</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 25-29 high      no              65    27     0.293</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 30-39 low       yes            112    33     0.228</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 30-39 low       no              77    80     0.510</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> 30-39 high      yes            118    46     0.280</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> 30-39 high      no              68    78     0.534</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> 40-49 low       yes             35     6     0.146</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> 40-49 low       no              46    48     0.511</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> 40-49 high      yes              8     8     0.5  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> 40-49 high      no              12    31     0.721</span></span></code></pre>
<p>Now, group and summarize by age:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cuse2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fracusing</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">##   age   `mean(fracusing)`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> &lt;25               0.188</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 25-29             0.271</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 30-39             0.388</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 40-49             0.469</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cuse2</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 16 × 6</span></span></span>
<span><span class="co">##    age   education wantsMore notUsing using fracusing</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> &lt;25   low       yes             53     6     0.102</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> &lt;25   low       no              10     4     0.286</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> &lt;25   high      yes            212    52     0.197</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> &lt;25   high      no              50    10     0.167</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 25-29 low       yes             60    14     0.189</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 25-29 low       no              19    10     0.345</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 25-29 high      yes            155    54     0.258</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 25-29 high      no              65    27     0.293</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 30-39 low       yes            112    33     0.228</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 30-39 low       no              77    80     0.510</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> 30-39 high      yes            118    46     0.280</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> 30-39 high      no              68    78     0.534</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> 40-49 low       yes             35     6     0.146</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> 40-49 low       no              46    48     0.511</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> 40-49 high      yes              8     8     0.5  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> 40-49 high      no              12    31     0.721</span></span></code></pre>
<p>Here the <code>%&gt;%</code> is called a “pipe”, and it sends the
output of the previous function to the input of the next function. This
could also have been done in one step:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">cuse</span>, fracusing <span class="op">=</span> <span class="va">using</span> <span class="op">/</span> <span class="op">(</span><span class="va">using</span> <span class="op">+</span> <span class="va">notUsing</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fracusing</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">##   age   `mean(fracusing)`</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> &lt;25               0.188</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 25-29             0.271</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 30-39             0.388</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 40-49             0.469</span></span></code></pre>
<p>Here the result is not stored anywhere; if you wanted to store it in
a variable called <code>myanswer</code>, you could have started the
above command with <code>myanswer &lt;-</code> or
<code>myanswer =</code>.</p>
<p>Also note that the line breaks are optional: you could put this all
on one line, but breaking it up makes it more readable.</p>
</div>
<div class="section level2">
<h2 id="write-on-paper-the-model-for-expected-probability-of-using-birth-control">Write on paper the model for expected probability of using birth
control<a class="anchor" aria-label="anchor" href="#write-on-paper-the-model-for-expected-probability-of-using-birth-control"></a>
</h2>
<p>Based on <code>fit1</code>, write on paper the model for expected
probability of using birth control? Don’t forget the (inverse) logit
function.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">using</span>, <span class="va">notUsing</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">education</span> <span class="op">+</span> <span class="va">wantsMore</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cuse</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>I’m going to store the coefficients of <code>fit1</code> in a new
variable <code>b</code> just to save typing when writing out the
formula, and round to two decimal places:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bcoef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Here I’m going to take advantage of R Markdown’s support for LaTeX
formulae to write out the fitted regression model. I also use the ` r
2+2 ` syntax (the result is 4) for putting results of R code inline,
instead of writing out numbers of the coefficients. I never wrote the
number “four”, but you’ll have to look at the .Rmd to see how I did
that! Doing this in reports allows you to update them as input data
changes, without having to manually re-enter or copy numbers.</p>
<p><span class="math inline">\(P = \textit{logit}^{-1} \left(  -1.13 +
0.39 \times \textit{age25-29} +  0.91 \times \textit{age30-39} +  1.19
\times \textit{age40-49} +  0.32 \times \textit{educationhigh} +  -0.83
\times \textit{wantsMoreyes}  \right)\)</span></p>
<p><span class="math inline">\(\textit{logit}^{-1}(x) =
\frac{1}{1+e^{-x}}\)</span></p>
</div>
<div class="section level2">
<h2 id="what-is-the-expected-probability">What is the expected probability…<a class="anchor" aria-label="anchor" href="#what-is-the-expected-probability"></a>
</h2>
<p>Based on <code>fit1</code>, what is the expected probability of an
individual 25-29 years old, with high education, who wants more
children, using birth control? Calculate it manually, and using
<code>predict(fit1)</code></p>
<p><strong>Solution</strong></p>
<p>This can be done using the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function, using a
new <code>data.frame</code> giving the values that you want to predict
for:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">invLogit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q4data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="st">"25-29"</span>, education<span class="op">=</span><span class="st">"high"</span>, wantsMore<span class="op">=</span><span class="st">"yes"</span><span class="op">)</span></span>
<span><span class="fu">invLogit</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span>, newdata<span class="op">=</span><span class="va">q4data</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         1 </span></span>
<span><span class="co">## 0.2223899</span></span></code></pre>
<p>By default, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> predicts on the original data, and
taking a look, I noticed that the 7th value is the one we want to
predict on:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">invLogit</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         7 </span></span>
<span><span class="co">## 0.2223899</span></span></code></pre>
<p>If we were really doing this manually, on paper, we would just
calculate the linear predictor, then use the inverse logit function.
Note that education=“high” is the reference group, so we don’t use it
here:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">invLogit</span><span class="op">(</span> <span class="va">bcoef</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> <span class="va">bcoef</span><span class="op">[</span><span class="st">"age25-29"</span><span class="op">]</span> <span class="op">+</span> <span class="va">bcoef</span><span class="op">[</span><span class="st">"wantsMoreyes"</span><span class="op">]</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## (Intercept) </span></span>
<span><span class="co">##   0.1722164</span></span></code></pre>
<p>I don’t <em>really</em> care, but if the remnant “(Intercept)” name
there were annoying me, I would assign this to a variable then get rid
of that name:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">invLogit</span><span class="op">(</span> <span class="va">bcoef</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span> <span class="op">+</span> <span class="va">bcoef</span><span class="op">[</span><span class="st">"age25-29"</span><span class="op">]</span> <span class="op">+</span> <span class="va">bcoef</span><span class="op">[</span><span class="st">"wantsMoreyes"</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.1722164</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="predicted-odds-ratio">Predicted odds ratio<a class="anchor" aria-label="anchor" href="#predicted-odds-ratio"></a>
</h2>
<p>Based on <code>fit1</code>: Relative to women under 25 who want to
have children, what is the predicted odds ratio for a woman 40-49 years
old who does <em>not</em> want to have children will be taking birth
control?</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="st">"age40-49"</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="st">"wantsMoreyes"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## age40-49 </span></span>
<span><span class="co">##  7.55488</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="likelihood-ratio-test">Likelihood Ratio Test<a class="anchor" aria-label="anchor" href="#likelihood-ratio-test"></a>
</h2>
<p>Using a likelihood ratio test, is there evidence that a model with
interactions improves on <code>fit1</code> (no interactions)?</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">using</span>, <span class="va">notUsing</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">*</span> <span class="va">education</span> <span class="op">*</span> <span class="va">wantsMore</span>, </span>
<span>           data<span class="op">=</span><span class="va">cuse</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit1.int</span>, test<span class="op">=</span><span class="st">"LRT"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: cbind(using, notUsing) ~ age + education + wantsMore</span></span>
<span><span class="co">## Model 2: cbind(using, notUsing) ~ age * education * wantsMore</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        10     29.917                          </span></span>
<span><span class="co">## 2         0      0.000 10   29.917 0.0008838 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="a-model-with-interactions">A model with interactions<a class="anchor" aria-label="anchor" href="#a-model-with-interactions"></a>
</h2>
<p>Which, if any, variables have the strongest interactions? I use the
“stargazer” package here which is extremely flexible for showing
regression results from all kinds of models, capable of comparing
multiple models or multiple dependent variables in the same table, and
providing formatting customized to numerous journal styles.</p>
<p><strong>Solution</strong></p>
<p>We see here that the strongest interaction coeffient is for
<code>age30-39:wantsMoreyes</code>. It is statistically significant and
negative (0). It appears that being 30-39 years old and wanting more
children has a multiplicative effect against using birth control, moreso
than expected based on the age or wanting more children alone.</p>
<p>The <em>stargazer</em> package is a good way to create
nicely-formatted tables of regression results.</p>
<table style="text-align:center" class="table">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Outcome: Using Birth Control
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
No Interaction
</td>
<td>
With Interactions
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29
</td>
<td>
0.39<sup>**</sup> (0.04, 0.73)
</td>
<td>
0.27 (-1.12, 1.66)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39
</td>
<td>
0.91<sup>***</sup> (0.59, 1.23)
</td>
<td>
0.95 (-0.25, 2.16)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49
</td>
<td>
1.19<sup>***</sup> (0.77, 1.61)
</td>
<td>
0.96 (-0.27, 2.19)
</td>
</tr>
<tr>
<td style="text-align:left">
educationhigh
</td>
<td>
0.32<sup>***</sup> (0.08, 0.57)
</td>
<td>
-0.69 (-2.04, 0.65)
</td>
</tr>
<tr>
<td style="text-align:left">
wantsMoreyes
</td>
<td>
-0.83<sup>***</sup> (-1.06, -0.60)
</td>
<td>
-1.26<sup>*</sup> (-2.70, 0.17)
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29:educationhigh
</td>
<td>
</td>
<td>
0.46 (-1.15, 2.07)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39:educationhigh
</td>
<td>
</td>
<td>
0.79 (-0.63, 2.21)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49:educationhigh
</td>
<td>
</td>
<td>
1.60<sup>**</sup> (0.05, 3.15)
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29:wantsMoreyes
</td>
<td>
</td>
<td>
0.45 (-1.28, 2.18)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39:wantsMoreyes
</td>
<td>
</td>
<td>
0.002 (-1.52, 1.52)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49:wantsMoreyes
</td>
<td>
</td>
<td>
-0.54 (-2.27, 1.18)
</td>
</tr>
<tr>
<td style="text-align:left">
educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
1.47<sup>*</sup> (-0.15, 3.08)
</td>
</tr>
<tr>
<td style="text-align:left">
age25-29:educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
-0.83 (-2.79, 1.13)
</td>
</tr>
<tr>
<td style="text-align:left">
age30-39:educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
-1.29 (-3.04, 0.47)
</td>
</tr>
<tr>
<td style="text-align:left">
age40-49:educationhigh:wantsMoreyes
</td>
<td>
</td>
<td>
-0.61 (-2.83, 1.61)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-1.13<sup>***</sup> (-1.50, -0.77)
</td>
<td>
-0.92 (-2.08, 0.24)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
16
</td>
<td>
16
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-50.71
</td>
<td>
-35.75
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
113.43
</td>
<td>
103.51
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div class="section level2">
<h2 id="contrasts-between-every-pair-of-age-groups">Contrasts between every pair of age groups<a class="anchor" aria-label="anchor" href="#contrasts-between-every-pair-of-age-groups"></a>
</h2>
<p>Create a model matrix for a fit on age only, with contrasts between
<em>every pair</em> of age groups. Between which age groups is the
contrast significant?</p>
<p><strong>Solution</strong></p>
<div class="section level3">
<h3 id="semi-manually">semi-manually<a class="anchor" aria-label="anchor" href="#semi-manually"></a>
</h3>
<p>First, I’ll do it manually, using the <code>multcomp</code> package
and following an example from <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">?glht</a></code>. I’m not going to
bother anymore creating pretty tables with <code>stargazer</code>
though…</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">using</span>, <span class="va">notUsing</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">cuse</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## (Intercept)    age25-29    age30-39    age40-49 </span></span>
<span><span class="co">##  -1.5071591   0.4606758   1.0482932   1.4246380</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="st">"25-29 - &lt;25"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>           <span class="st">"30-39 - &lt;25"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>           <span class="st">"40-49 - &lt;25"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>           <span class="st">"30-39 - 25-29"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>           <span class="st">"40-49 - 25-29"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>           <span class="st">"40-49 - 30-39"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K</span></span></code></pre></div>
<pre><code><span><span class="co">##               [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">## 25-29 - &lt;25      0    1    0    0</span></span>
<span><span class="co">## 30-39 - &lt;25      0    0    1    0</span></span>
<span><span class="co">## 40-49 - &lt;25      0    0    0    1</span></span>
<span><span class="co">## 30-39 - 25-29    0   -1    1    0</span></span>
<span><span class="co">## 40-49 - 25-29    0   -1    0    1</span></span>
<span><span class="co">## 40-49 - 30-39    0    0   -1    1</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.all.cont</span> <span class="op">=</span> <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">fit</span>, linfct<span class="op">=</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.all.cont</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Simultaneous Tests for General Linear Hypotheses</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fit: glm(formula = cbind(using, notUsing) ~ age, family = binomial("logit"), </span></span>
<span><span class="co">##     data = cuse)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Linear Hypotheses:</span></span>
<span><span class="co">##                    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## 25-29 - &lt;25 == 0     0.4607     0.1727   2.667   0.0375 *  </span></span>
<span><span class="co">## 30-39 - &lt;25 == 0     1.0483     0.1544   6.788   &lt;0.001 ***</span></span>
<span><span class="co">## 40-49 - &lt;25 == 0     1.4246     0.1940   7.345   &lt;0.001 ***</span></span>
<span><span class="co">## 30-39 - 25-29 == 0   0.5876     0.1406   4.181   &lt;0.001 ***</span></span>
<span><span class="co">## 40-49 - 25-29 == 0   0.9640     0.1831   5.265   &lt;0.001 ***</span></span>
<span><span class="co">## 40-49 - 30-39 == 0   0.3763     0.1660   2.268   0.1035    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## (Adjusted p values reported -- single-step method)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="using-tukey-contrasts">Using Tukey contrasts<a class="anchor" aria-label="anchor" href="#using-tukey-contrasts"></a>
</h3>
<p>There is an easier way if you realize that these are the “Tukey”
contrasts and use the <code>contrMat</code> function from the
<code>multcomp</code> package. These automatic contrasts assume a
no-intercept model, which would be hard to interpret outside the context
of <code><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html" class="external-link">multcomp::contrMat</a></code>, but can be used as an intermediate
step to get here.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitnoint</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">using</span>, <span class="va">notUsing</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span><span class="op">-</span><span class="fl">1</span>, data<span class="op">=</span><span class="va">cuse</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K2</span> <span class="op">=</span> <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html" class="external-link">contrMat</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, type<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span></span>
<span><span class="va">K2</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        1  2  3 4</span></span>
<span><span class="co">## 2 - 1 -1  1  0 0</span></span>
<span><span class="co">## 3 - 1 -1  0  1 0</span></span>
<span><span class="co">## 4 - 1 -1  0  0 1</span></span>
<span><span class="co">## 3 - 2  0 -1  1 0</span></span>
<span><span class="co">## 4 - 2  0 -1  0 1</span></span>
<span><span class="co">## 4 - 3  0  0 -1 1</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.all.cont2</span> <span class="op">=</span> <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">fitnoint</span>, linfct<span class="op">=</span><span class="va">K2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit.all.cont2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Simultaneous Tests for General Linear Hypotheses</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fit: glm(formula = cbind(using, notUsing) ~ age - 1, family = binomial("logit"), </span></span>
<span><span class="co">##     data = cuse)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Linear Hypotheses:</span></span>
<span><span class="co">##            Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## 2 - 1 == 0   0.4607     0.1727   2.667   0.0375 *  </span></span>
<span><span class="co">## 3 - 1 == 0   1.0483     0.1544   6.788   &lt;0.001 ***</span></span>
<span><span class="co">## 4 - 1 == 0   1.4246     0.1940   7.345   &lt;0.001 ***</span></span>
<span><span class="co">## 3 - 2 == 0   0.5876     0.1406   4.181   &lt;0.001 ***</span></span>
<span><span class="co">## 4 - 2 == 0   0.9640     0.1831   5.265   &lt;0.001 ***</span></span>
<span><span class="co">## 4 - 3 == 0   0.3763     0.1660   2.268   0.1034    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## (Adjusted p values reported -- single-step method)</span></span></code></pre>
<p>We didn’t get the same informative coefficient names this time, but
we can rename the rows in <code>K2</code>, for example:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">K2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="va">K2</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                1  2  3 4</span></span>
<span><span class="co">## 25-29 - &lt;25   -1  1  0 0</span></span>
<span><span class="co">## 30-39 - &lt;25   -1  0  1 0</span></span>
<span><span class="co">## 40-49 - &lt;25   -1  0  0 1</span></span>
<span><span class="co">## 30-39 - 25-29  0 -1  1 0</span></span>
<span><span class="co">## 40-49 - 25-29  0 -1  0 1</span></span>
<span><span class="co">## 40-49 - 30-39  0  0 -1 1</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">fit</span>, linfct<span class="op">=</span><span class="va">K2</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Simultaneous Tests for General Linear Hypotheses</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fit: glm(formula = cbind(using, notUsing) ~ age, family = binomial("logit"), </span></span>
<span><span class="co">##     data = cuse)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Linear Hypotheses:</span></span>
<span><span class="co">##                    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## 25-29 - &lt;25 == 0     1.9678     0.2841   6.926   &lt;0.001 ***</span></span>
<span><span class="co">## 30-39 - &lt;25 == 0     2.5555     0.2734   9.347   &lt;0.001 ***</span></span>
<span><span class="co">## 40-49 - &lt;25 == 0     2.9318     0.2975   9.854   &lt;0.001 ***</span></span>
<span><span class="co">## 30-39 - 25-29 == 0   0.5876     0.1406   4.181   &lt;0.001 ***</span></span>
<span><span class="co">## 40-49 - 25-29 == 0   0.9640     0.1831   5.265   &lt;0.001 ***</span></span>
<span><span class="co">## 40-49 - 30-39 == 0   0.3763     0.1660   2.268    0.098 .  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## (Adjusted p values reported -- single-step method)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="other-contrast-schemes">Other contrast schemes<a class="anchor" aria-label="anchor" href="#other-contrast-schemes"></a>
</h3>
<p>There are plenty of canned contrast schemes provided by
<code><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html" class="external-link">multcomp::contrMat</a></code>. Note use of the <code><a href="https://rdrr.io/r/utils/example.html" class="external-link">example()</a></code>
function to run all examples from the <code>contrmat()</code> function.
This is a great example of how there are <strong>many</strong> ways to
analyze one particular experimental design, but that you need to know
design matrices to utilize many of them.</p>
<p>In these examples, the first line <code>n &lt;- c(10,20,30,40)</code>
just signifies four levels, <code>n = 1:4</code> would do exactly the
same thing.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org" class="external-link">multcomp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="st">"contrMat"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  n &lt;- c(10,20,30,40)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  names(n) &lt;- paste("group", 1:4, sep="")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n) # Dunnett is default</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Dunnett Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 group1 group2 group3 group4</span></span>
<span><span class="co">## group2 - group1     -1      1      0      0</span></span>
<span><span class="co">## group3 - group1     -1      0      1      0</span></span>
<span><span class="co">## group4 - group1     -1      0      0      1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, base = 2)   # use second level as baseline</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Dunnett Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 group1 group2 group3 group4</span></span>
<span><span class="co">## group1 - group2      1     -1      0      0</span></span>
<span><span class="co">## group3 - group2      0     -1      1      0</span></span>
<span><span class="co">## group4 - group2      0     -1      0      1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "Tukey")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Tukey Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 group1 group2 group3 group4</span></span>
<span><span class="co">## group2 - group1     -1      1      0      0</span></span>
<span><span class="co">## group3 - group1     -1      0      1      0</span></span>
<span><span class="co">## group4 - group1     -1      0      0      1</span></span>
<span><span class="co">## group3 - group2      0     -1      1      0</span></span>
<span><span class="co">## group4 - group2      0     -1      0      1</span></span>
<span><span class="co">## group4 - group3      0      0     -1      1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "Sequen")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Sequen Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 group1 group2 group3 group4</span></span>
<span><span class="co">## group2 - group1     -1      1      0      0</span></span>
<span><span class="co">## group3 - group2      0     -1      1      0</span></span>
<span><span class="co">## group4 - group3      0      0     -1      1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "AVE")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: AVE Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      group1  group2  group3  group4</span></span>
<span><span class="co">## C 1  1.0000 -0.2222 -0.3333 -0.4444</span></span>
<span><span class="co">## C 2 -0.1250  1.0000 -0.3750 -0.5000</span></span>
<span><span class="co">## C 3 -0.1429 -0.2857  1.0000 -0.5714</span></span>
<span><span class="co">## C 4 -0.1667 -0.3333 -0.5000  1.0000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "Changepoint")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Changepoint Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      group1  group2  group3 group4</span></span>
<span><span class="co">## C 1 -1.0000  0.2222  0.3333 0.4444</span></span>
<span><span class="co">## C 2 -0.3333 -0.6667  0.4286 0.5714</span></span>
<span><span class="co">## C 3 -0.1667 -0.3333 -0.5000 1.0000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "Williams")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Williams Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     group1 group2 group3 group4</span></span>
<span><span class="co">## C 1     -1 0.0000 0.0000 1.0000</span></span>
<span><span class="co">## C 2     -1 0.0000 0.4286 0.5714</span></span>
<span><span class="co">## C 3     -1 0.2222 0.3333 0.4444</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "Marcus")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: Marcus Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      group1  group2  group3 group4</span></span>
<span><span class="co">## C 1 -1.0000  0.2222  0.3333 0.4444</span></span>
<span><span class="co">## C 2 -1.0000  0.0000  0.4286 0.5714</span></span>
<span><span class="co">## C 3 -0.3333 -0.6667  0.4286 0.5714</span></span>
<span><span class="co">## C 4 -1.0000  0.0000  0.0000 1.0000</span></span>
<span><span class="co">## C 5 -0.3333 -0.6667  0.0000 1.0000</span></span>
<span><span class="co">## C 6 -0.1667 -0.3333 -0.5000 1.0000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "McDermott")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: McDermott Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      group1  group2 group3 group4</span></span>
<span><span class="co">## C 1 -1.0000  1.0000    0.0      0</span></span>
<span><span class="co">## C 2 -0.3333 -0.6667    1.0      0</span></span>
<span><span class="co">## C 3 -0.1667 -0.3333   -0.5      1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  ### Umbrella-protected Williams contrasts, i.e. a sequence of </span></span>
<span><span class="co">## cntrMt&gt;  ### Williams-type contrasts with groups of higher order </span></span>
<span><span class="co">## cntrMt&gt;  ### stepwise omitted</span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "UmbrellaWilliams")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: UmbrellaWilliams Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     group1 group2 group3 group4</span></span>
<span><span class="co">## C 1     -1 0.0000 0.0000 1.0000</span></span>
<span><span class="co">## C 2     -1 0.0000 0.4286 0.5714</span></span>
<span><span class="co">## C 3     -1 0.2222 0.3333 0.4444</span></span>
<span><span class="co">## C 4     -1 0.0000 1.0000 0.0000</span></span>
<span><span class="co">## C 5     -1 0.4000 0.6000 0.0000</span></span>
<span><span class="co">## C 6     -1 1.0000 0.0000 0.0000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## cntrMt&gt;  ### comparison of each group with grand mean of all groups</span></span>
<span><span class="co">## cntrMt&gt;  contrMat(n, type = "GrandMean")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Multiple Comparisons of Means: GrandMean Contrasts</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        group1 group2 group3 group4</span></span>
<span><span class="co">## group1    0.9   -0.2   -0.3   -0.4</span></span>
<span><span class="co">## group2   -0.1    0.8   -0.3   -0.4</span></span>
<span><span class="co">## group3   -0.1   -0.2    0.7   -0.4</span></span>
<span><span class="co">## group4   -0.1   -0.2   -0.3    0.6</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://waldronlab.io" class="external-link">Levi Waldron</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
